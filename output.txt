BEGIN
[CLIENT] I want to start my first handshake with the server!
[SERVER] I received a hello from the client!
[SERVER] I will make a public and private key!
[SERVER] I've made them and saved the private key
[SERVER] Public Key: -----BEGIN PUBLIC KEY-----
MIICJDCCARcGCSqGSIb3DQEDATCCAQgCggEBAPyCu8IhIrztihVuOuCrCQoNfocy
VC+cgqaQbgVusS+eIKczRPDtCeGLokLEPHT5LVUT8uE6kqElSAVExvN6lvVa6O5l
WJfQMdSmQB92tTil0LwAGkPkreAC/YmpGa2NWOUz99IgQtJN6RwTrBesoTSoxdnp
VW15DRoIHfczWjm3V4YjUWJoCOjOdhNbKcWQQbq9mzSmPziaDgnov8r0+nvsqN2L
pl4+ZAGd38bM5qc4RUKA+w5/SEV/fUFlNCyelT6TV6NOBudRvlZXmJ5wpFXSF4wp
KZeS9vigS0fKlBoOIDQ13bvH/kxUjEU9I0/q7h+iua6Srp+yk+K/CUywmf8CAQID
ggEFAAKCAQAl4lnm+W4rhFc80BT0xoApoArJbnAh0JMYM3x4tDfLSPIrYSBwwjwS
MozcuYzUHbVWo169ELzy477cnd3Qru99qZCNGg2BEpV1b72Nm/0LpPe/m9EVevZ/
gx1VdQT8NwWvjbXDgS4M6S3WGT97Oyr40jpnZVOPLcEZgSRBsex87r0or7T8Cigy
1S8Cs03liYvS7M6pJDFNXeE/Vpr33ARw+m1iZigKIQwCUnHVJmy86xLbTmwAej5X
BMgJszNiGTz2Wrkc9S8f8RLX4Hs124OLlfmp6s2J9w9Cg1h5OMJGseNrT9WyRJld
okwx+dwJEAHFBD3BABEwVmcQsffYoj4T
-----END PUBLIC KEY-----

[SERVER] Sending back the user this [public key]: -----BEGIN PUBLIC KEY-----
MIICJDCCARcGCSqGSIb3DQEDATCCAQgCggEBAPyCu8IhIrztihVuOuCrCQoNfocy
VC+cgqaQbgVusS+eIKczRPDtCeGLokLEPHT5LVUT8uE6kqElSAVExvN6lvVa6O5l
WJfQMdSmQB92tTil0LwAGkPkreAC/YmpGa2NWOUz99IgQtJN6RwTrBesoTSoxdnp
VW15DRoIHfczWjm3V4YjUWJoCOjOdhNbKcWQQbq9mzSmPziaDgnov8r0+nvsqN2L
pl4+ZAGd38bM5qc4RUKA+w5/SEV/fUFlNCyelT6TV6NOBudRvlZXmJ5wpFXSF4wp
KZeS9vigS0fKlBoOIDQ13bvH/kxUjEU9I0/q7h+iua6Srp+yk+K/CUywmf8CAQID
ggEFAAKCAQAl4lnm+W4rhFc80BT0xoApoArJbnAh0JMYM3x4tDfLSPIrYSBwwjwS
MozcuYzUHbVWo169ELzy477cnd3Qru99qZCNGg2BEpV1b72Nm/0LpPe/m9EVevZ/
gx1VdQT8NwWvjbXDgS4M6S3WGT97Oyr40jpnZVOPLcEZgSRBsex87r0or7T8Cigy
1S8Cs03liYvS7M6pJDFNXeE/Vpr33ARw+m1iZigKIQwCUnHVJmy86xLbTmwAej5X
BMgJszNiGTz2Wrkc9S8f8RLX4Hs124OLlfmp6s2J9w9Cg1h5OMJGseNrT9WyRJld
okwx+dwJEAHFBD3BABEwVmcQsffYoj4T
-----END PUBLIC KEY-----

[CLIENT] Public Key: -----BEGIN PUBLIC KEY-----
MIICJDCCARcGCSqGSIb3DQEDATCCAQgCggEBAPyCu8IhIrztihVuOuCrCQoNfocy
VC+cgqaQbgVusS+eIKczRPDtCeGLokLEPHT5LVUT8uE6kqElSAVExvN6lvVa6O5l
WJfQMdSmQB92tTil0LwAGkPkreAC/YmpGa2NWOUz99IgQtJN6RwTrBesoTSoxdnp
VW15DRoIHfczWjm3V4YjUWJoCOjOdhNbKcWQQbq9mzSmPziaDgnov8r0+nvsqN2L
pl4+ZAGd38bM5qc4RUKA+w5/SEV/fUFlNCyelT6TV6NOBudRvlZXmJ5wpFXSF4wp
KZeS9vigS0fKlBoOIDQ13bvH/kxUjEU9I0/q7h+iua6Srp+yk+K/CUywmf8CAQID
ggEFAAKCAQAl4lnm+W4rhFc80BT0xoApoArJbnAh0JMYM3x4tDfLSPIrYSBwwjwS
MozcuYzUHbVWo169ELzy477cnd3Qru99qZCNGg2BEpV1b72Nm/0LpPe/m9EVevZ/
gx1VdQT8NwWvjbXDgS4M6S3WGT97Oyr40jpnZVOPLcEZgSRBsex87r0or7T8Cigy
1S8Cs03liYvS7M6pJDFNXeE/Vpr33ARw+m1iZigKIQwCUnHVJmy86xLbTmwAej5X
BMgJszNiGTz2Wrkc9S8f8RLX4Hs124OLlfmp6s2J9w9Cg1h5OMJGseNrT9WyRJld
okwx+dwJEAHFBD3BABEwVmcQsffYoj4T
-----END PUBLIC KEY-----

[CLIENT] Private Key Saved!
[SERVER] I received a public key from the client! This is still the handshake
[SERVER] I need to decrypt (if we're using a session key) the public key and use HKDF to make a session key
[SERVER] We don't have a session key, we can just retreive the public key
[SERVER] Using the public key I got, I made a session_key. I assume it matches up because me and the client agree on parameters and our keys.
[CLIENT] Doing my second handshake with the server for forward secrecy!
[SERVER] I received a hello from the client!
[SERVER] I will make a public and private key!
[SERVER] I've made them and saved the private key
[SERVER] Public Key: -----BEGIN PUBLIC KEY-----
MIICJTCCARcGCSqGSIb3DQEDATCCAQgCggEBAKND8WhQ5+sLRpAZZB/045JVdLZz
XMSOmA9CvJ2hG9Qf3IIZXw0Dsr6Qkq8SUP3gaezoFVOk/iC1SHrvbxE0zRr1sdAy
xB/CsbBZGQggbElyGLCNxotzjqpvk/RuV8SBZPKur5LpygYiqdR6R1vFXg3kAfKf
1YUrZOzTM1hBpCDl+7aQ4hlXjMLqDI7gqjiH0rgInlRBIQ3qucPK+d8/uw3mnvAY
/L1zJW97r4OXKWklJfmy6BHGLpg8FDQeN9BytSBWGqKeFH/I7cYtNG8HCt2DqyxX
I408vCjSfAeePbM7ffHxJQLUXU03c9wbSSUrZreJ7tt+tJcqJUfu2aup/ucCAQID
ggEGAAKCAQEAlw0eWh7qglvln9vADimz9whkCmUF8qdeeLaivzFb+urWnRz3dNqy
IhfEHJZaHzORPXKvKA3VvkaOgtTVxUt1h0DyTQRciyMaFZEeA42XwHjfUWW0dtEU
n9pKB9soYrJZ//YdV+/IbLM70QGdCobdZSUh0uxdeCQRmXGhWqiMtMwhRSx9orWG
BX808Ll+EzULXkuzvshlC2ZJziFpnDXPU1MrRJN3llR3Fht7HjWpFJx+U2oyjRje
CvAJ3lIoYcSfEnEXvePFj4ZnkO0nv44nCWBLjGGCre6WjV782DNwgfLQTE0fpUKj
t9UoguvGMIQlBAJ4bqN0fNp4et64hWoptw==
-----END PUBLIC KEY-----

[SERVER] I already have a session_key with this client! I will use that as a layer of protection
[SERVER] Sending back the user this [public key]: uXmxWWpbDejqbjiQc/HnG3KbDghB90uqWRjicgfdp0IKPM4CdzMT1upg4mLXH8Gu1Uj787F36lSl81edwzTUM3e791HpBgXrE7DDIIPo7xCBUm88GmvNFHAehUYHSXccZ3zwvEegvibF4jSn35XkKQgLZRNw5obRTbvyU5a7mts84RJ7iACQxEuKBltWYDo5wF9Hsm1YrljXaquFjLAULuBRjcjCthBQE7T88dhzc2sTw+7Ak4Ljy3sygmohleTSkhyHI+LvzU9/vTHOJg+Kgp0rVA3tew81MbsL7a1xIzSjek2f7jnMtA1tgz7H2gzDJ4MW6wva8PTVf7qMr513QRfMHJyXOLKNAXbVKVTK5xLsL2Pk/jmcqgARes0R++7jrC2PGp0DRJmvqAEGY92lsPsguIB+8Bf3cyDm4+7yUr2eStN9/8D0lwAKzg1ORG+0MKQUUzK2hwong8sN0KNLg5fHuIXs6zlSkEh1k9N5Gg2xOmu4RxRxALbaYX/z7sEDRFju2XQYrt062zebS49Q6Ng2NcyFOrdyBHG218DpomHzNFI1z6NNVt23IjwdfZ45dOoiHHw0BHX67PK97BGskbcE914Jb8GstKcVLdduYePSYxWXawxw9ITZTeCAMCkrj9wqop37eS5zI8c0GeG7bWwkuRiGYOxETLz16kWIS7imOHgawoYGTGwaqxKxLmWBlX1YZt3yJQ6v0WWAXgwAKlCtwROnXukGfrY+UonNV/ze173MoRcAxvTgeeJg592zSX+FqsVRmo0e/GYqtNPovem2tLehUaYJL6d9OfwpKne1daQFXWauUZno6S2E0087BSG13IkDpmPNU8Hly0L17D27C5X9TxCiVKnGGu6dz0tTx2yKvruk4kw/gy1wdcB3+vZIVxH5vm6iiMvscr3QhccXD4h7CQpYohlj4K5CDq8DIGCOs3gNOVa/cts93BEJIa3CkrmQzpET+n5V9NgZIB33HLqDViWp2SpFlAskS4dvoc/qo4YM7qFTz+2uYkHUaVwcWbq5axOe6BxNhTF0vDWSZSNzBT9oQ4SZ1QmJFl+1O4C5874XtN9KCcjNVvzW1fq0yT4YZAs7lc6Ceg4abQ==
[CLIENT] Public Key: uXmxWWpbDejqbjiQc/HnG3KbDghB90uqWRjicgfdp0IKPM4CdzMT1upg4mLXH8Gu1Uj787F36lSl81edwzTUM3e791HpBgXrE7DDIIPo7xCBUm88GmvNFHAehUYHSXccZ3zwvEegvibF4jSn35XkKQgLZRNw5obRTbvyU5a7mts84RJ7iACQxEuKBltWYDo5wF9Hsm1YrljXaquFjLAULuBRjcjCthBQE7T88dhzc2sTw+7Ak4Ljy3sygmohleTSkhyHI+LvzU9/vTHOJg+Kgp0rVA3tew81MbsL7a1xIzSjek2f7jnMtA1tgz7H2gzDJ4MW6wva8PTVf7qMr513QRfMHJyXOLKNAXbVKVTK5xLsL2Pk/jmcqgARes0R++7jrC2PGp0DRJmvqAEGY92lsPsguIB+8Bf3cyDm4+7yUr2eStN9/8D0lwAKzg1ORG+0MKQUUzK2hwong8sN0KNLg5fHuIXs6zlSkEh1k9N5Gg2xOmu4RxRxALbaYX/z7sEDRFju2XQYrt062zebS49Q6Ng2NcyFOrdyBHG218DpomHzNFI1z6NNVt23IjwdfZ45dOoiHHw0BHX67PK97BGskbcE914Jb8GstKcVLdduYePSYxWXawxw9ITZTeCAMCkrj9wqop37eS5zI8c0GeG7bWwkuRiGYOxETLz16kWIS7imOHgawoYGTGwaqxKxLmWBlX1YZt3yJQ6v0WWAXgwAKlCtwROnXukGfrY+UonNV/ze173MoRcAxvTgeeJg592zSX+FqsVRmo0e/GYqtNPovem2tLehUaYJL6d9OfwpKne1daQFXWauUZno6S2E0087BSG13IkDpmPNU8Hly0L17D27C5X9TxCiVKnGGu6dz0tTx2yKvruk4kw/gy1wdcB3+vZIVxH5vm6iiMvscr3QhccXD4h7CQpYohlj4K5CDq8DIGCOs3gNOVa/cts93BEJIa3CkrmQzpET+n5V9NgZIB33HLqDViWp2SpFlAskS4dvoc/qo4YM7qFTz+2uYkHUaVwcWbq5axOe6BxNhTF0vDWSZSNzBT9oQ4SZ1QmJFl+1O4C5874XtN9KCcjNVvzW1fq0yT4YZAs7lc6Ceg4abQ==
[CLIENT] Private Key Saved!
[SERVER] I received a public key from the client! This is still the handshake
[SERVER] I need to decrypt (if we're using a session key) the public key and use HKDF to make a session key
[SERVER] We have a session key! We will first decrypt the message and then retreive the pubk
[SERVER] Using the public key I got, I made a session_key. I assume it matches up because me and the client agree on parameters and our keys.
[CLIENT] With forward secrecy established, we will now encrypt a message over the secure channel
[CLIENT] Key: yKhZBmI1JkJb2GcBzchC5w==
[CLIENT] Encrypted Key: iLupHwTLbfQCjk/+NCFdtEDSCEHkc4WGL9Tk5gCDWjKYYTHSCdCfSVykvYzmUnhR+JlyAkZcM6+qKmEDJZNYaWt1m43g34KV1C/rnmIDIoI=
[CLIENT] We now will encrypt everything with our session key! I would output it, but the format of HKDF doens't support utf-8 conversions
[CLIENT] Encrypted key (with session key): 9QpP7ksWL/HR4zIfbgJoxoXaXgigucj2vCzhd6F76DcgWlYHbl9GV82RrgXY68QC
[CLIENT] Encrypted message (with session key): J6LK2xyKJCWuHFXPpfKfdnQ/LO4ggwFgEGzpDtTUPkw5yyfFixWgtw3GDIkC9OyHkweJRlcFfKbLBpX1Nv4bSip4AsmcXJo1iyw7fJLuwUDUJKuEMSvo3vGpslHjiMZF9k6S01QJLv2KXwzAAkXHu9fVBe52uoj2iemT6aTLdas=
[CLIENT] Sending this over to the server!
[SERVER] I received the msg route! This means, our channel is secure and I need to decrypt + decrypt the message with the symmetric key
[SERVER] Decrypting everything past the session_key ekey: yKhZBmI1JkJb2GcBzchC5w==
[SERVER] Decrypting everything past the session_key emsg: aUx1cEh3VExiZlFDamsvK05DRmR0RURTQ0VIa2M0V0dMOVRrNWdDRFdqS1lZVEhTQ2RDZlNWeWt2WXptVW5oUitKbHlBa1pjTTYrcUttRURKWk5ZYVd0MW00M2czNEtWMUMvcm5tSURJb0k9
[SERVER] Finally we can decrypt the message! msg: Hello! This is a sample message I want to send :)
[CLIENT] Final Message back! Hello! This is a sample message I want to send :)
